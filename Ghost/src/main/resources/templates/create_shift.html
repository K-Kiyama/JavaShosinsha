<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
  <head>
    <title>test</title>
  </head>

  <body width="2000px" height="2000px">
    <meta http-equiv="content-type" content="text/html;charset=UTF-8">
    <link rel="stylesheet" href="fullcalendar/fullcalendar.css" media="all"/>
    <link rel="stylesheet" href="style.css" media="all"/>    
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src='fullcalendar/lib/jquery.min.js'></script>
    <script src='fullcalendar/lib/moment.min.js'></script>
    <script src='fullcalendar/fullcalendar.js'></script>
    <script src='fullcalendar/locale/ja.js'></script>

    <h1 style="text-align:center;">管理者画面</h1>
    <div id="calendar">
        <form method="POST" action="./master.html">
        <input type="submit" value="完了" />
        </form>
    </div>

    <input type="button" value="Get" onclick="getList()"/>
    
    <script>
        // ページ読み込み時の処理
        $(document).ready(function () {
            // カレンダーの設定
            $('#calendar').fullCalendar({
                height: 550,
                location: "ja",
                editable: true,
                eventLimit: true,
                dayClick: function(date, allDay, jsEvent, view) {
                    var title = prompt('シフトを入力してください:');
                    newevent=[{
                        id:title,
                        title:title,
                        start:date
                    }]
                    $('#calendar').fullCalendar('addEventSource',newevent);
                },
                eventClick:function(event){
                    var title=prompt("シフトを更新します(空白で削除)");
                    if(title&&title!=""){
                        event.title=title;
                        $('#calendar').fullCalendar('updateEvent',event);
                    }else{
                        $('#calendar').fullCalendar('removeEvents',event.id);
                    }
                }
            })
        });
        function getList(){
            event_list = $('#calendar').fullCalendar("clientEvents");
            console.log(event_list)
            for(let i=0;i<event_list.length;i++){
                d = event_list[i].id._d
                day = "20"+String(('00'+(d.getFullYear())).slice(-2))+"-"+String(('00'+(d.getMonth()+1)).slice(-2))+"-"+String(('00'+d.getDate()).slice(-2));
                name= String(event_list[i].title);
                newevent={
                    title:name,
                    start:day
                }
                shiftList.push(newevent);
            }
        }
        //neweventからシフトリストにnameとdayを送ってやる
    </script>
    </head>
  </body>
</html>